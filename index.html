<script>
const name = "Aleksandra Florek";
function randDigits(n){ let s=''; for(let i=0;i<n;i++) s += Math.floor(Math.random()*10); return s; }
const acctMask = `PL-${randDigits(4)}-${randDigits(4)}-${randDigits(4)}`;
const balanceFixed = 15323.35;

function zlToGrosze(zl){ return Math.round(Number(zl)*100); }
function groszeToStr(grosze){
  const sign = grosze < 0 ? '-' : '';
  const abs = Math.abs(grosze);
  const zl = Math.floor(abs / 100);
  const cents = String(abs % 100).padStart(2,'0');
  return sign + zl.toLocaleString('pl-PL') + '.' + cents + ' PLN';
}

/* funkcja toast przeniesiona wyÅ¼ej, Å¼eby dziaÅ‚aÅ‚a od razu */
function showToast(msg){
  const toast = document.createElement('div');
  toast.className = 'toast';
  toast.textContent = msg;
  document.getElementById('toastContainer').appendChild(toast);
  setTimeout(()=>toast.remove(),4000);
}

const transactions = [
  { daysAgo: 1, desc: "Militaria", site: "militaria.pl", amountG: zlToGrosze(-847.99) },
  { date: "04.05.2025", desc: "Jeulia JEWELLERY LIMITED", site: "jeulia.com", amountG: zlToGrosze(-640.00) },
  { date: "12.04.2025", desc: "Sklep OdzieÅ¼owy", site: "greenpoint.pl", amountG: zlToGrosze(-259.99) },
  { date: "19.03.2025", desc: "Buty - Sklep Obuwniczy", site: "jdsports.pl", amountG: zlToGrosze(-499.00) },
  { date: "12.03.2025", desc: "Sklep Elektroniczny", site: "euro.com", amountG: zlToGrosze(-720.50) },
  { date: "14.08.2024", desc: "DINO BORZECHOW 1 K.1", site: "brak", amountG: zlToGrosze(-189.25) },
  { date: "27.12.2024", desc: "OLX", site: "olx.pl", amountG: zlToGrosze(-450.00) },
  { date: "21.05.2025", desc: "ORLEN STACJA NR.432", site: "blik", amountG: zlToGrosze(-243.00) },
  { date: "11.12.2024", desc: "ISPOT", site: "ispot.pl", amountG: zlToGrosze(-890.99) },
];

// âž• nowe wpÅ‚aty
const newDeposits = [
  { desc: "Przelew wewnetrzny â€” listopad 2025", amount: 2100.00 },
  { desc: "Wplata â€” pazdziernik 2025", amount: 5200.00 },
  { desc: "Wplata â€” pazdziernik 2025", amount: 5000.00 },
  { desc: "Przelew wewnetrzny â€” wrzesnien 2025", amount: 2300.00 },
  { desc: "Przelew wewnetrzny â€” styczen 2024", amount: 7600.00 }
];

newDeposits.forEach(dep => {
  const tx = {
    date: new Date().toLocaleDateString('pl-PL'),
    desc: dep.desc,
    site: "zlecenie",
    amountG: zlToGrosze(dep.amount)
  };
  transactions.unshift(tx);
});

// pokaÅ¼ toast dla najnowszej wpÅ‚aty
const lastDeposit = newDeposits[0];
showToast(`Nowa wpÅ‚ata: +${lastDeposit.amount.toFixed(2)} PLN (${lastDeposit.desc})`);

// ðŸ§¾ UzupeÅ‚nianie danych
document.getElementById('acctName').textContent = name;
document.getElementById('acctNum').textContent = "Nr konta: " + acctMask;
document.getElementById('balance').textContent = balanceFixed.toFixed(2).replace(',', '.') + " PLN";
document.getElementById('createdDate').textContent = new Date().toLocaleString('pl-PL');

// ðŸ§® Generowanie tabeli
const txBody = document.getElementById('txBody');
let sumG = 0;
transactions.forEach(tx => {
  if (tx.amountG < 0 ) sumG += Number(tx.amountG);
  const tr = document.createElement('tr');
  const amtClass = tx.amountG < 0 ? 'amount-deb' : 'amount-cred';
  const amountText = groszeToStr(tx.amountG);
  const dateStr = tx.date || new Date().toLocaleDateString('pl-PL');
  const siteHtml = (typeof tx.site === 'string' && tx.site !== "brak") 
    ? `<a href="https://${tx.site}" target="_blank" rel="noreferrer noopener">${tx.site}</a>` 
    : "â€”";
  tr.innerHTML = `
    <td>${dateStr}</td>
    <td class="merchant">${tx.desc}</td>
    <td class="muted">${siteHtml}</td>
    <td style="text-align:right"><span class="${amtClass}">${amountText}</span></td>`;
  txBody.appendChild(tr);
});
document.getElementById('sumFoot').textContent = groszeToStr(sumG);
</script>
